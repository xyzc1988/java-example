<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <script type="text/javascript" src="./js/jquery/jquery-3.2.1.js"></script>
    <!--jQuery2.0+不再支持IE8-->
    <!--[if lte IE 8]>
    <script src="http://cdn.bootcss.com/jquery/1.9.0/jquery.min.js"></script>
    <script src="https://cdn.bootcss.com/es5-shim/4.5.9/es5-shim.min.js"></script>
    <script src="https://cdn.bootcss.com/es5-shim/4.5.9/es5-sham.min.js"></script>
    <script src="https://cdn.bootcss.com/json3/3.3.2/json3.min.js"></script>
    <![endif]-->
    <script type="text/javascript" src="./js/pagination/jqPagination.js"></script>
    <script type="text/javascript" src="./js/pagination/jquery.pagination.js"></script>
    <!-- <script type="text/javascript" src="./js/pagination/mricode.pagination.js"></script>-->
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/normalize.css">
    <link href="./js/pagination/pager.css" rel="stylesheet"/>
    <link href="./js/pagination/pagination.css" rel="stylesheet"/>

    <script type="text/javascript">
        $(function () {
            $('#pager').jqPagination({
                url: "./page/getPage",
                pageSize: 1,
                paginationClass: "pager",
                showJump: true,
                param: {
                    a: 1
                },
                success: function (data) {
                    //返回的数据根据自己需要处理
                    var tableStr = "<tr><td>Id</td><td>姓名</td><td>年龄</td></tr>";
                    $.each(data.data, function (i, v) {
                        tableStr += "<tr><td>" + v.name + "</td><td>" + v.china + "</td><td>" + v.type + "</td></tr>";
                    });

                    $('#dataTable').html(tableStr);
                },
                complete: function () {
                }
            });
            /*$.ajax({
                url: "./page/getPage",
                type: "POST",
                dataType: "JSON",
                data: JSON.stringify({pageIndex: 1, pageSize: 1}),
                contentType:"application/json",
            }).then(function (data) {
                rendHtml(data)
                $('#pager').pagination({
                    pageSize:1,
                    totalCount:data.totalCount,
                    prevContent: '上页',		//上一页内容
                    nextContent: '下页',
                    jump:true,
                    callback: function (api) {
                        var pageIndex = api.getPageIndex();
                        $.ajax({
                            url: "./page/getPage",
                            type: "POST",
                            dataType: "JSON",
                            data: JSON.stringify({pageIndex: pageIndex, pageSize: 1}),
                            contentType: "application/json",
                        }).then(function (data) {
                            rendHtml(data);
                        })
                    }
                });

            })*/
            $.ajax({
                url: "./page/getBase64Image",
                type: "GET",
            }).then(function (data) {
                $("#image1").attr("src", data);

            });

           /* preloadimages(["./page/getImage"])*/

        });

        function rendHtml(data) {
            var tableStr = "<tr><td>Id</td><td>姓名</td><td>年龄</td></tr>";
            $.each(data.data, function (i, v) {
                tableStr += "<tr><td>" + v.name + "</td><td>" + v.china + "</td><td>" + v.type + "</td></tr>";
            });

            $('#dataTable').html(tableStr);
        }

        function preloadimages(arr) {
            var newimages=[], loadedimages=0;
            var arr=(typeof arr!="object")? [arr] : arr;

            function imageloadpost(){
                loadedimages++
                if (loadedimages==arr.length){
                    alert("图片已经加载完成")
                }
            }

            for (var i=0; i<arr.length; i++){
                newimages[i]=new Image();
                newimages[i].src=arr[i];
                newimages[i].onload=function(){
                    imageloadpost()
                };
                newimages[i].onerror=function(){
                    imageloadpost()
                }
            }
        }
    </script>

</head>
<body>

<table id="dataTable" border="1" style="width: 100%"></table>
<br/>
<div id="pager"></div>

<img id="image" src="./page/getImage" style="width: 50px;height: 50px;"/>
<img id="image1" style="width: 50px;height: 50px;"/>
<img id="image2" src="./page/getImageBody" style="width: 100px;height: 100px;"/>
</body>
</html>
